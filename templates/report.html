{% extends "base.html" %}

{% block content %}
<h2>{{start}} - {{end}}</h2>
<form method="get">
    <button formaction="index.html">Food Menu</button>
</form>
<table>

{% for day in days %}
  {% if not day.meals|length %}
    <tr><th colspan=7>{{day.date|dateformat}} was not recorded</th></tr>
  {% else %}
    <tr>
      <th colspan="7">{{day.date|dateformat}}</th>
    </tr>
    <tr>
      <th>Meal</th>
      <th>Item</th>
      <th>Servings</th>
      <th>Cals</th>
      <th>Carbs</th>
      <th>Fat</th>
      <th>Protein</th>
    </tr>
    {% for meal in day.meals %} {# meal[1] is list of courses #}
      {% set course = meal[1][0] %}
      <tr>
        <th rowspan="{{meal[1]|length}}">{{meal[0]}}</th>
          <td>{{course.dish|truncate(40, False)}}</td>
          <td>{{course.servings}}</td>
          <td>{{course.calories}}</td>
          <td>{{course.carbs}}</td>
          <td>{{course.fat}}</td>
          <td>{{course.protein}}</td>
        </th>
      </tr>
      {% for course in meal[1][1:] %}
        <tr>
          <td>{{course.dish|truncate(40, False)}}</td>
          <td>{{course.servings}}</td>
          <td>{{course.calories}}</td>
          <td>{{course.carbs}}</td>
          <td>{{course.fat}}</td>
          <td>{{course.protein}}</td>
        </tr>
      {% endfor %}
    {% endfor %}
  <tr>
    <th colspan="3">Total</th>
    <td>{{day.total.calories}}</td>
    <td>{{day.total.carbs}}</td>
    <td>{{day.total.fat}}</td>
    <td>{{day.total.protein}}</td>
  </tr>
  {% endif %}
{% endfor %}
</table>
<form method="get">
    <button formaction="index.html">Food Menu</button>
</form>
recomputed on {{now}}
{% endblock %}
